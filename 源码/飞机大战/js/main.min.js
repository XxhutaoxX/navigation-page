"use strict";window.onload=function(){Game.init()};var Game={box:document.getElementById("box"),fenshu:0,img:function(){this.oPlane=new Image,this.oPlane.src="images/plane.png",this.oPlane.className="plane"},init:function(){var e=this;setTimeout(function(){e.box.style.background="url(images/1.jpg)";var t=e.ctE("h3");t.innerHTML="飞机大战";var n=e.ctE("div");n.innerHTML='<p class="ac">简单</p><p class="ac">一般</p><p class="ac">困难</p>',e.box.appendChild(t),e.box.appendChild(n),e.img();for(var i=n.children,s=0;s<i.length;s++)i[s].index=s,i[s].onmouseover=function(){this.className="on"},i[s].onmouseout=function(){this.className="ac"},i[s].onclick=e.start},300)},start:function(e){function t(e){Game.box.style.background="url(images/"+e+".jpg)",setInterval(function(){n+=1,Game.box.style.backgroundPosition="0px "+n+"px"},30)}e=e||event;var n=0,i=0,s=0,o=0;0==this.index?(t(3),i=100,s=6,o=500):1==this.index?(t(4),i=150,s=15,o=400):2==this.index&&(t(5),i=200,s=20,o=300),Game.box.innerHTML="",Game.plane(e,i,s),Game.start.timer=setInterval(function(){Game.enemy()},o),Game.score()},plane:function(e,t,n){var i=this;this.box.appendChild(this.oPlane);var s=this.box.offsetTop+this.oPlane.clientHeight/2+(this.box.offsetHeight-Game.getstyle(Game.box,"height"))/2,o=this.box.offsetLeft+this.oPlane.clientWidth/2+(this.box.offsetWidth-Game.getstyle(Game.box,"width"))/2,a=e.pageY-s,l=e.pageX-o;this.oPlane.style.cssText="top:"+a+"px;left:"+l+"px;";var r=this.getstyle(this.box,"height")-this.oPlane.clientHeight/2,h=-this.oPlane.clientWidth/2,c=this.getstyle(this.box,"width")-this.oPlane.clientWidth/2;document.onmousemove=function(e){e=e||event,a=e.pageY-s,l=e.pageX-o,a<0?a=0:a>r&&(a=r),l<h?l=h:l>c&&(l=c),i.oPlane.style.cssText="top:"+a+"px;left:"+l+"px;"},this.bTimer=setInterval(function(){i.bullet(a,l,n)},t)},bullet:function(e,t,n){var i=this.ctE("img");i.src="images/bullet.png",i.className="bullet",this.box.appendChild(i);var s=e-this.getstyle(i,"height")+5,o=t+this.oPlane.clientWidth/2-this.getstyle(i,"width")/2;i.style.cssText="top:"+s+"px;left:"+o+"px;",i.timer=setInterval(function(){return i.parentNode?(s-=n,i.style.top=s+"px",void(s<-22&&(clearInterval(i.timer),i.parentNode.removeChild(i)))):void clearInterval(i.timer)},30)},enemy:function(){var e=this,t=this.ctE("img");t.src="images/enemy.png",t.className="enemy",this.box.appendChild(t);var n=Math.random()*(this.box.clientWidth-this.getstyle(t,"width")/2),i=this.getstyle(t,"top");t.style.left=n+"px",t.timer=setInterval(function(){if(i+=3,t.style.top=i+"px",i>e.box.clientHeight){if(clearInterval(t.tiamr),!t.parentNode)return;t.parentNode.removeChild(t)}else{for(var n=e.getclass(e.box,"img","bullet"),s=0;s<n.length;s++)e.pz(t,n[s])&&(n[s].parentNode.removeChild(n[s]),t.src="images/boom.png",clearInterval(t.timer),setTimeout(function(){t.parentNode&&t.parentNode.removeChild(t)},500),e.num+=10,e.oScore.innerHTML=e.num+"分",e.fenshu=e.oScore.innerHTML);e.pz(t,e.oPlane)&&(t.src="images/boom.png",clearInterval(t.timer),setTimeout(function(){t.parentNode&&t.parentNode.removeChild(t)},500),e.oPlane.src="images/boom2.png",clearInterval(e.bTimer),clearInterval(e.start.timer),document.onmousemove=null,setTimeout(function(){e.over()},3e3))}},30)},over:function(){this.box.innerHTML="";var e=this.num;console.log(e);var t=this.ctE("p"),n="";e<100?n="你太年轻了":e<1e3?n="渐入佳境":e<3e3?n="江湖老手":e<6e3&&(n="玩的很6"),t.innerHTML="获得称号:"+n;var i=this.ctE("div"),s=this.ctE("p"),o=this.ctE("p"),a=this.ctE("p");s.innerHTML="GG!",a.innerHTML="最后得分:"+this.fenshu,o.innerHTML="重新开始",t.className="rate",s.className="op1",i.className="over",a.className="oSpan",o.className="reStart",o.id="reStart",this.box.appendChild(i),i.appendChild(s),i.appendChild(a),i.appendChild(o),this.insertAfter(t,a),document.getElementById("reStart").onclick=function(){i.parentNode.removeChild(i),window.open("index.html","_self")}},score:function(){this.oScore=this.ctE("span"),this.oScore.className="score",this.num=0,this.oScore.innerHTML=this.num+"分",this.box.appendChild(this.oScore)},pz:function(e,t){var n=this.getstyle(e,"top"),i=n+this.getstyle(e,"height"),s=this.getstyle(e,"left"),o=s+this.getstyle(e,"width"),a=this.getstyle(t,"top"),l=a+this.getstyle(t,"height"),r=this.getstyle(t,"left"),h=r+this.getstyle(t,"width");return!(n>l||s>h||i<a||o<r)},getclass:function(e,t,n){for(var i=e.getElementsByTagName(t),s=[],o="",a=0;a<i.length;a++){o=i[a].className.split(" ");for(var l=0;l<o.length;l++)if(o[l]==n){s.push(i[a]);break}}return s},insertAfter:function(e,t){var n=t.parentNode;n.lastChild==t?n.appendChild(e):n.insertBefore(e,t.nextSibling)},ctE:function(e){return document.createElement(e)},getstyle:function(e,t){return e.currentstyle?parseInt(e.currentstyle[t]):parseInt(getComputedStyle(e)[t])}};